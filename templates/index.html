<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <title>Chat Kriptografi Aman</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="bg-light">

<div class="container mt-5">
  <div class="card shadow-lg p-4">
    <h1 class="text-center text-primary mb-4">ğŸ’¬ Chat Kriptografi Aman</h1>

    {% if session.get('user') %}
      <div class="alert alert-success text-center">Halo, {{ session.user }}! 
        <a href="{{ url_for('logout') }}" class="btn btn-sm btn-outline-danger ms-2">Logout</a>
      </div>

      <h4>Kirim Pesan</h4>
      <form method="post" action="{{ url_for('send_message') }}">
        <div class="mb-3">
          <label>Penerima</label>
          <select class="form-select" name="receiver">
            {% for u in users %}
              <option value="{{ u }}">{{ u }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="mb-3">
          <label>Pesan</label>
          <textarea class="form-control" name="message" rows="3"></textarea>
        </div>
        <button class="btn btn-primary">Kirim</button>
      </form>

      <hr>

      <a href="{{ url_for('inbox') }}" class="btn btn-outline-primary">ğŸ“¥ Lihat Pesan Masuk</a>
      <a href="{{ url_for('files') }}" class="btn btn-outline-secondary">ğŸ“‚ Lihat File</a>
      <a href="{{ url_for('stego_inbox') }}" class="btn btn-outline-success">ğŸ–¼ï¸ Lihat Stego</a>

    {% else %}
      <h3 class="text-center mb-3">Silakan Login atau Registrasi</h3>
      <div class="row">
        <div class="col-md-6">
          <h5>Login</h5>
          <form method="post" action="{{ url_for('login') }}">
            <div class="mb-3">
              <label>Username</label>
              <input class="form-control" name="username">
            </div>
            <div class="mb-3">
              <label>Password</label>
              <input type="password" class="form-control" name="password">
            </div>
            <button class="btn btn-success w-100">Login</button>
          </form>
        </div>
        <div class="col-md-6">
          <h5>Registrasi</h5>
          <form method="post" action="{{ url_for('register') }}">
            <div class="mb-3">
              <label>Username</label>
              <input class="form-control" name="r_username">
            </div>
            <div class="mb-3">
              <label>Password</label>
              <input type="password" class="form-control" name="r_password">
            </div>
            <button class="btn btn-primary w-100">Daftar</button>
          </form>
        </div>
      </div>
    {% endif %}

    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div class="mt-4 alert alert-info">
          {% for m in messages %}
            <div>{{ m }}</div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
  </div>
</div>

</body>
</html>